#mobile-nav {
    display: none;
    gap: 1ch;

    button {
        flex-grow: 1;
    }
}

h1::before {
    content: '# ';
}
h2::before {
    content: '## ';
}
h3::before {
    content: '### ';
}
h4::before {
    content: '#### ';
}
h5::before {
    content: '##### ';
}
h6::before {
    content: '###### ';
}

#sidebar-container {
    display: flex;
    width: var(--sidebar-width, 32ch);
    max-width: 100vw;
    min-width: 16ch;
    flex: 0 0 var(--sidebar-width, 32ch);
}

#sidebar-container.collapsed {
    max-width: 6ch;
    width: 6ch;
    min-width: 6ch;
    flex-basis: 6ch;
}

#sidebar-container.collapsed + #sidebar-resizer {
    display: none;
}

#sidebar-resizer {
    flex: 0 0 0.5ch;
    align-self: stretch;
    height: auto;
    cursor: col-resize;
    background: var(--background1);
    border-left: 1px solid var(--background2);
    border-right: 1px solid var(--background2);
    margin-block: 0.5lh;
}

#sidebar-resizer:hover,
#sidebar-resizer.dragging {
    background: var(--background0);
    border-color: var(--foreground2);
}

#sidebar-container.collapsed #category-container,
#sidebar-container.collapsed #sidebar-vim-nav-container {
    display: none;
}

#scroll-container {
    position: relative;
    flex-grow: 1;

    #main-content {
        position: absolute;
        inset: 0;
        display: flex;
        flex-direction: column;
        gap: 1lh;
        padding: 1lh 1ch;
        overflow-y: auto;
        color: var(--foreground1);

        strong {
            color: var(--foreground0);
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-smoothing: subpixel-antialiased;
        }

        & > [tabindex='0'],
        & > ul > li[tabindex='0'] {
            outline: none;

            &:focus {
                background-color: oklch(
                    from var(--accent, var(--foreground, #838383))
                        calc(l * 0.85) c h / 0.1
                );

                &:not(:is(pre)) code {
                    background-color: var(--background2);
                }

                &:has(> div.image-caption) {
                    background-color: var(--background0);

                    figcaption {
                        background-color: var(--background1);
                    }
                }

                &:is(pre) {
                    span.line:first-child {
                        background-color: var(--background2);
                    }
                }
            }
        }

        /* li > p { */
        /*     display: inline; */
        /*     margin: 0; */
        /* } */

        li > p + p {
            display: block;
        }

        li {
            text-indent: 2ch hanging;
        }
        /* li > p { */
        /*     margin-block: 1lh; */
        /* } */
        li:last-child {
            margin-bottom: 1lh;
        }

        li > details[is-~='accordion'] {
            margin-left: 2ch;
        }

        #doc-pagination {
            display: flex;
            flex-wrap: wrap;

            &:has(> .prev) {
                justify-content: flex-start;
            }

            &:has(> .next) {
                justify-content: flex-end;
            }

            &:has(> .prev):has(> .next) {
                justify-content: space-between;
            }

            /* a { */
            /*     color: var(--blue); */
            /*     text-decoration: none; */
            /*     display: flex; */
            /*     flex-direction: column; */
            /*     --box-border-color: var(--background2); */
            /*     outline: none; */
            /**/
            /*     &.next { */
            /*         text-align: right; */
            /*     } */
            /**/
            /*     &:hover, */
            /*     &:focus { */
            /*         --box-border-color: var(--red); */
            /*     } */
            /* } */
            a:focus:focus-visible {
                color: var(--accent);
                background-color: oklch(
                    from var(--accent) calc(l * 0.85) c h / 0.1
                );
            }
        }
    }
}

article {
    display: flex;
    flex-direction: column;
    flex-grow: 1;

    &:focus-within {
        --box-border-color: var(--foreground0);
    }
}

@media (max-width: 120ch) {
    #sidebar-container {
        max-width: 100%;
    }

    #sidebar-resizer {
        display: none;
    }

    #sidebar-container.collapsed {
        max-width: 100%;
        width: 100%;
    }

    #sidebar-container.collapsed #category-container,
    #sidebar-container.collapsed #sidebar-vim-nav-container {
        display: block;
    }

    #sidebar-toggle {
        display: none;
    }

    #mobile-nav {
        display: flex;
    }

    .mobile-hidden {
        display: none !important;
    }

    .next,
    .prev {
        flex-grow: 1;

        code {
            display: none;
        }
    }
}

/* Syntax Highlighting */
pre.astro-code {
    display: flex !important;
    overflow: unset !important;
    position: relative;
    /* background-color: var(--background1) !important; */

    code {
        background-color: unset;
        overflow: hidden;

        /* Diff markers */
        /* span.diff.add { */
        /*     background-color: #a6e3a135; */
        /* } */
        /**/
        /* span.diff.remove { */
        /*     background-color: #f38ba845; */
        /* } */
    }
}

/* .astro-code, */
/* .astro-code span { */
/*     --shiki-dark-bg: var(--background1) !important; */
/*     color: var(--shiki-dark) !important; */
/*     background-color: var(--shiki-dark-bg) !important; */
/*     /* Optional, if you also want font styles */
*/
/*     font-style: var(--shiki-dark-font-style) !important; */
/*     font-weight: var(--shiki-dark-font-weight) !important; */
/*     text-decoration: var(--shiki-dark-text-decoration) !important; */
/* } */

p:has(> img) {
    display: flex;

    max-width: 48ch;
    max-height: 24lh;
    width: 100%;

    img {
        object-fit: contain;
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
    }
}
